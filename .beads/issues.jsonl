{"id":"nixcfg-03a","title":"Add flake checks","description":"**Current state:** Pre-commit hooks exist in devShell (git-hooks.lib with nixfmt, deadnix, statix, ruff, shellcheck, shfmt, mdformat). A checks.formatting output exists for the formatter.\n\n**Still needed:** Add explicit `checks` output that runs pre-commit validation as part of `nix flake check`:\n\n```nix\nchecks = {\n  pre-commit = pre-commit-hooks.run {\n    hooks = {\n      nixfmt.enable = true;\n      statix.enable = true;\n    };\n  };\n};\n```","status":"open","priority":3,"issue_type":"feature","created_at":"2026-01-10T16:22:24.309178-08:00","created_by":"george","updated_at":"2026-01-21T10:09:11.692548-08:00"}
{"id":"nixcfg-0gz","title":"Update google-chrome to 144.0.7559.60 in nixpkgs","description":"Nixpkgs has 143.0.7499.193, Homebrew has 144.0.7559.60. Chrome updates frequently. Update needed to migrate from Homebrew to Nixpkgs for NixOS compatibility.\n\n## Migration Instructions (Homebrew → Nix)\n\n### Option A: Nixpkgs version is sufficient\nIf nixpkgs has the version you need:\n\n1. **Check for Home Manager module**: Look for `programs.\u003cname\u003e` at https://nix-community.github.io/home-manager/options.html\n\n2. **If module exists** (preferred):\n   ```nix\n   # In home/george/configuration.nix under programs = { ... }\n   programs.\u003cname\u003e.enable = true;\n   ```\n\n3. **If no module**, check if nixpkgs has the package:\n   ```bash\n   nix eval --raw nixpkgs#\u003cname\u003e.version\n   ```\n   Then add to packages:\n   ```nix\n   # In home/george/packages.nix\n   home.packages = with pkgs; [ \u003cname\u003e ];\n   ```\n\n4. **Remove from Homebrew**: Delete from `modules/darwin/george/brew-apps.nix` (brews or casks list)\n\n5. **Rebuild**: `nh darwin switch --no-nom .`\n\n### Option B: Need newer version than nixpkgs (create overlay)\n\n1. **Add flake input** in `flake.nix`:\n   ```nix\n   \u003cname\u003e = {\n     url = \"github:\u003cowner\u003e/\u003crepo\u003e/v\u003cversion\u003e\";\n     flake = false;\n   };\n   ```\n\n2. **Create overlay** in `overlays.nix` (pattern depends on build system):\n\n   **For Rust packages (`buildRustPackage`):**\n   ```nix\n   \u003cname\u003e = prev.\u003cname\u003e.overrideAttrs {\n     version = \"\u003cversion\u003e\";\n     src = inputs.\u003cname\u003e;\n     cargoDeps = prev.rustPlatform.fetchCargoVendor {\n       src = inputs.\u003cname\u003e;\n       hash = \"\u003chash\u003e\";  # Use lib.fakeHash first, build to get correct hash\n     };\n   };\n   ```\n\n   **For npm packages (`buildNpmPackage`):**\n   ```nix\n   \u003cname\u003e = let\n     npmDepsHash = \"\u003chash\u003e\";  # Use lib.fakeHash first\n   in prev.\u003cname\u003e.overrideAttrs {\n     version = \"\u003cversion\u003e\";\n     src = inputs.\u003cname\u003e;\n     inherit npmDepsHash;\n     npmDeps = prev.fetchNpmDeps {\n       src = inputs.\u003cname\u003e;\n       hash = npmDepsHash;\n     };\n   };\n   ```\n   Note: Must override BOTH npmDepsHash AND npmDeps for npm packages.\n\n   **For Go packages (`buildGoModule`):**\n   ```nix\n   \u003cname\u003e = prev.\u003cname\u003e.overrideAttrs {\n     version = \"\u003cversion\u003e\";\n     src = inputs.\u003cname\u003e;\n     vendorHash = \"\u003chash\u003e\";  # Use lib.fakeHash first\n   };\n   ```\n\n3. **Get correct hash**: Build with `lib.fakeHash`, copy the \"got:\" hash from error\n\n4. **Update flake.lock**: `nix flake update \u003cname\u003e`\n\n5. **Continue with Option A steps** (HM module or packages, remove from Homebrew, rebuild)\n\n### Verification\n- Binary: `which \u003cname\u003e` should show `/etc/profiles/per-user/george/bin/\u003cname\u003e`\n- Version: `\u003cname\u003e --version` should show expected version","status":"closed","priority":3,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-15T22:00:36.235647-08:00","created_by":"gkze","updated_at":"2026-01-16T00:59:00.266247-08:00","closed_at":"2026-01-16T00:59:00.266247-08:00","close_reason":"Migrated google-chrome from Homebrew to Nix with overlay for version 144.0.7559.60"}
{"id":"nixcfg-0i0","title":"update.py: allow render sizing injection for tests","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-19T16:19:57.440388-08:00","created_by":"gkze","updated_at":"2026-01-21T10:09:42.091222-08:00","closed_at":"2026-01-21T10:09:42.091222-08:00","close_reason":"Already implemented: Renderer class accepts panel_height parameter (line 1454), and UPDATE_PANEL_HEIGHT env var is supported (lines 132-143)"}
{"id":"nixcfg-0i7","title":"Migrate OpenCode Desktop to crate2nix for per-crate caching","status":"closed","priority":2,"issue_type":"feature","owner":"george.kontridze@gmail.com","created_at":"2026-01-21T14:18:34.75091-08:00","created_by":"gkze","updated_at":"2026-01-21T16:24:04.480272-08:00","closed_at":"2026-01-21T16:24:04.480272-08:00","close_reason":"ABANDONED: Based on upstream Zed PR #45543 research (jrobsonchase, closed Jan 8 2026). After 3 weeks of work, crate2nix was abandoned due to: (1) minimal caching improvement - intra-workspace deps still cause rebuilds, (2) significant eval performance hit from IFD and derivation count, (3) broken devShell - C libs not properly included, (4) crate2nix maintenance issues (11mo stale, required fork). Crane's buildDepsOnly achieves similar benefits without complexity. Recommendation: stick with Crane or rustPlatform.buildRustPackage. Reference: https://github.com/zed-industries/zed/pull/45543","dependencies":[{"issue_id":"nixcfg-0i7","depends_on_id":"nixcfg-gwe","type":"blocks","created_at":"2026-01-21T14:19:26.889011-08:00","created_by":"gkze"},{"issue_id":"nixcfg-0i7","depends_on_id":"nixcfg-axe","type":"blocks","created_at":"2026-01-21T14:19:27.57969-08:00","created_by":"gkze"}]}
{"id":"nixcfg-1xc","title":"update.py: extract hash resolver helpers","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-19T16:19:56.806342-08:00","created_by":"gkze","updated_at":"2026-01-19T16:46:48.251956-08:00","closed_at":"2026-01-19T16:46:48.251956-08:00","close_reason":"Closed"}
{"id":"nixcfg-2n7","title":"Create OpenCode Desktop Tauri crate overrides","description":"Create overrides for Tauri/GTK/WebKit stack: glib-sys, gobject-sys, gio-sys, gtk-sys, gdk-sys, cairo-sys-rs, pango-sys, gdk-pixbuf-sys, atk-sys, webkit2gtk, libappindicator-sys. Linux-only (macOS uses native WebKit).","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-21T14:18:56.271935-08:00","created_by":"gkze","updated_at":"2026-01-21T16:24:04.42507-08:00","closed_at":"2026-01-21T16:24:04.42507-08:00","close_reason":"ABANDONED: Based on upstream Zed PR #45543 research (jrobsonchase, closed Jan 8 2026). After 3 weeks of work, crate2nix was abandoned due to: (1) minimal caching improvement - intra-workspace deps still cause rebuilds, (2) significant eval performance hit from IFD and derivation count, (3) broken devShell - C libs not properly included, (4) crate2nix maintenance issues (11mo stale, required fork). Crane's buildDepsOnly achieves similar benefits without complexity. Recommendation: stick with Crane or rustPlatform.buildRustPackage. Reference: https://github.com/zed-industries/zed/pull/45543","dependencies":[{"issue_id":"nixcfg-2n7","depends_on_id":"nixcfg-wpz","type":"blocks","created_at":"2026-01-21T14:19:25.14333-08:00","created_by":"gkze"}]}
{"id":"nixcfg-312","title":"Update codex to 0.86.0 in nixpkgs","description":"## Summary\nThe OpenAI Codex CLI is outdated in nixpkgs.\n\n- **nixpkgs version:** 0.80.0\n- **Homebrew version:** 0.84.0\n- **Homepage:** https://github.com/openai/codex\n\n## Current state\nCurrently installed via Homebrew cask in `modules/darwin/george/brew-apps.nix`.\n\n## Goal\nUpdate nixpkgs package to 0.84.0, then migrate from Homebrew to Nix.\n\n## Acceptance criteria\n- [ ] Submit PR to nixpkgs updating codex to 0.84.0\n- [ ] Once merged, remove from brew-apps.nix\n- [ ] Add to Nix packages","status":"closed","priority":3,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-15T22:05:43.91874-08:00","created_by":"gkze","updated_at":"2026-01-17T18:07:50.510466-08:00","closed_at":"2026-01-17T18:07:50.510466-08:00","close_reason":"Closed"}
{"id":"nixcfg-370","title":"Create modules/nixos/impermanence.nix","status":"open","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-18T01:39:09.716529-08:00","created_by":"gkze","updated_at":"2026-01-18T01:39:09.716529-08:00","dependencies":[{"issue_id":"nixcfg-370","depends_on_id":"nixcfg-tmh","type":"blocks","created_at":"2026-01-18T01:39:21.415503-08:00","created_by":"gkze"},{"issue_id":"nixcfg-370","depends_on_id":"nixcfg-53b","type":"discovered-from","created_at":"2026-01-18T01:39:22.74365-08:00","created_by":"gkze"}]}
{"id":"nixcfg-3to","title":"Add platform conditional for homebrew-zsh-completion overlay","description":"## Summary\nThe `homebrew-zsh-completion` overlay in `overlays.nix:61-78` fetches Homebrew zsh completions, which is only useful on Darwin where Homebrew exists.\n\n## Current code (overlays.nix:61-78)\n```nix\nhomebrew-zsh-completion = prev.stdenvNoCC.mkDerivation {\n  name = \"brew-zsh-compmletion\";\n  src = builtins.fetchurl {\n    url = outputs.lib.ghRaw {\n      owner = \"Homebrew\";\n      repo = \"brew\";\n      ...\n    };\n  };\n  ...\n};\n```\n\n## Issue\n- This package is fetched/built on all platforms, including NixOS where Homebrew doesn't exist\n- Wastes build time and store space on Linux systems\n\n## Fix options\n1. Wrap in `lib.optionalAttrs prev.stdenv.isDarwin`\n2. Move to a darwin-specific overlay file (see nixcfg-qec for overlay splitting)\n\n## Acceptance criteria\n- [ ] Only build homebrew-zsh-completion on Darwin\n- [ ] Ensure NixOS builds don't reference this package","status":"open","priority":3,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-14T21:12:23.083262-08:00","created_by":"gkze","updated_at":"2026-01-14T21:12:23.083262-08:00","dependencies":[{"issue_id":"nixcfg-3to","depends_on_id":"nixcfg-qec","type":"relates-to","created_at":"2026-01-14T21:13:28.380466-08:00","created_by":"gkze"}]}
{"id":"nixcfg-3xu","title":"update.py: extract render formatting helpers","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-19T16:19:57.230861-08:00","created_by":"gkze","updated_at":"2026-01-19T16:51:16.09694-08:00","closed_at":"2026-01-19T16:51:16.09694-08:00","close_reason":"Closed"}
{"id":"nixcfg-41d","title":"Fix SSH StrictHostKeyChecking vulnerability","description":"**File:** home/george/configuration.nix:207\n\n```nix\nStrictHostKeyChecking = \"no\"\n```\n\n**Risk:** Makes MITM attacks possible for all SSH connections\n**Fix:** Only disable for specific trusted hosts, or remove entirely","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-10T16:20:53.752457-08:00","created_by":"george","updated_at":"2026-01-17T22:32:45.436722-08:00","closed_at":"2026-01-17T22:32:45.436722-08:00","close_reason":"Fixed: SSH uses accept-new, removed global allowInsecure, 1Password uses nix pkg"}
{"id":"nixcfg-4k9","title":"update.py: add helper to drain value events","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-19T16:19:56.706446-08:00","created_by":"gkze","updated_at":"2026-01-19T16:46:48.136719-08:00","closed_at":"2026-01-19T16:46:48.136719-08:00","close_reason":"Closed"}
{"id":"nixcfg-4oc","title":"Fix spectre_oxi build missing lua symbols during linking","description":"Location: home/george/nixvim.nix:666\n\nThe spectre neovim plugin is currently disabled (spectre.enable = false) because the spectre_oxi build is missing lua symbols during linking.\n\nThis needs investigation to fix the build issue and re-enable the plugin.","status":"open","priority":3,"issue_type":"bug","created_at":"2026-01-10T16:15:55.004699-08:00","created_by":"george","updated_at":"2026-01-10T16:15:55.004699-08:00"}
{"id":"nixcfg-4tc","title":"update.py: introduce Config dataclass for defaults","status":"open","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-19T16:19:56.907656-08:00","created_by":"gkze","updated_at":"2026-01-19T16:19:56.907656-08:00"}
{"id":"nixcfg-50f","title":"Fix wallpaper path issue","description":"**File:** stylix.nix:7\n\n```nix\nimage = ./wallpaper.jpeg;\n```\n\n- Local file not tracked in git; may break on fresh clone\n- **Fix:** Add to git or use URL with pkgs.fetchurl","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-10T16:22:05.840273-08:00","created_by":"george","updated_at":"2026-01-21T10:08:54.406452-08:00","closed_at":"2026-01-21T10:08:54.406452-08:00","close_reason":"wallpaper.jpeg exists and is committed to the repo at home/george/wallpaper.jpeg"}
{"id":"nixcfg-53b","title":"NixOS deployment system for ceres (HP ZBook Firefly G7)","status":"open","priority":2,"issue_type":"feature","owner":"george.kontridze@gmail.com","created_at":"2026-01-18T01:39:00.122252-08:00","created_by":"gkze","updated_at":"2026-01-18T01:39:00.122252-08:00"}
{"id":"nixcfg-64s","title":"Fix platform-specific library extension in codesnap-nvim overlay","description":"## Summary\nThe codesnap-nvim overlay in `overlays.nix:199-202` hardcodes `.dylib` (macOS library extension), which will fail on Linux where the extension should be `.so`.\n\n## Current code (overlays.nix:199-202)\n```nix\nfunction fetch.ensure_lib()\n  return \"...${vprev.codesnap-nvim.passthru.codesnap-lib}/lib/libgenerator.dylib\"\nend\n```\n\n## Fix\nUse platform-conditional extension:\n```nix\nlibExt = if pkgs.stdenv.isDarwin then \"dylib\" else \"so\";\n# Then: libgenerator.${libExt}\n```\n\n## Acceptance criteria\n- [ ] Detect platform and use appropriate library extension\n- [ ] Test on both Darwin and Linux builds","status":"open","priority":1,"issue_type":"bug","owner":"george.kontridze@gmail.com","created_at":"2026-01-14T17:40:39.491658-08:00","created_by":"gkze","updated_at":"2026-01-14T17:40:39.491658-08:00"}
{"id":"nixcfg-67d","title":"Fix python.nix option type: oneOf -\u003e enum","status":"closed","priority":3,"issue_type":"bug","owner":"george.kontridze@gmail.com","created_at":"2026-01-24T11:47:42.764104-08:00","created_by":"gkze","updated_at":"2026-01-24T11:48:03.99218-08:00","closed_at":"2026-01-24T11:48:03.99218-08:00","close_reason":"Changed types.oneOf to types.enum"}
{"id":"nixcfg-691","title":"Consolidate lint/format config in flake.nix","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-27T15:24:08.736506-08:00","created_by":"gkze","updated_at":"2026-01-27T15:25:36.678057-08:00","closed_at":"2026-01-27T15:25:36.678057-08:00","close_reason":"Closed"}
{"id":"nixcfg-6mb","title":"Create mkDmgApp helper and fix sculptor duplicate fetchurl","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-27T15:24:08.904126-08:00","created_by":"gkze","updated_at":"2026-01-27T15:26:37.947893-08:00","closed_at":"2026-01-27T15:26:37.947893-08:00","close_reason":"Closed"}
{"id":"nixcfg-6o9","title":"Test and iterate Zed crate2nix build","description":"Build zed-editor-nightly with crate2nix and fix any override issues. Expect iterative debugging as crates fail due to missing native deps. Verify per-crate caching works (check /nix/store for individual crate derivations).","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-21T14:18:51.19997-08:00","created_by":"gkze","updated_at":"2026-01-21T16:24:04.379477-08:00","closed_at":"2026-01-21T16:24:04.379477-08:00","close_reason":"ABANDONED: Based on upstream Zed PR #45543 research (jrobsonchase, closed Jan 8 2026). After 3 weeks of work, crate2nix was abandoned due to: (1) minimal caching improvement - intra-workspace deps still cause rebuilds, (2) significant eval performance hit from IFD and derivation count, (3) broken devShell - C libs not properly included, (4) crate2nix maintenance issues (11mo stale, required fork). Crane's buildDepsOnly achieves similar benefits without complexity. Recommendation: stick with Crane or rustPlatform.buildRustPackage. Reference: https://github.com/zed-industries/zed/pull/45543","dependencies":[{"issue_id":"nixcfg-6o9","depends_on_id":"nixcfg-eei","type":"blocks","created_at":"2026-01-21T14:19:19.298251-08:00","created_by":"gkze"}]}
{"id":"nixcfg-711","title":"Remove global allowInsecure flag","description":"**File:** modules/common.nix:62\n\n```nix\nallowInsecure = true;\n```\n\n**Risk:** May allow installation of packages with known vulnerabilities\n**Fix:** Remove or document why it's necessary; use per-package overrides instead","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-10T16:20:53.858542-08:00","created_by":"george","updated_at":"2026-01-17T22:32:45.457406-08:00","closed_at":"2026-01-17T22:32:45.457406-08:00","close_reason":"Fixed: SSH uses accept-new, removed global allowInsecure, 1Password uses nix pkg"}
{"id":"nixcfg-7kr","title":"Add platform conditionals for Darwin-specific paths","description":"## Summary\nSeveral files contain hardcoded Darwin-specific paths that will fail on NixOS.\n\n## Affected files and paths\n\n### home/george/darwin.nix:19\n- `/usr/bin/ssh-add` - Darwin-specific binary location\n\n### modules/home/town.nix:16\n- `/opt/homebrew/bin/op` - Homebrew-installed 1Password CLI (see also nixcfg-ugs)\n\n### home/george/python.nix:33\n- `Library/Application Support` - macOS application support directory\n\n### home/george/configuration.nix:30\n- `:/usr/bin:/sbin` in PATH - Darwin system paths\n\n### modules/darwin/george/dock-apps.nix, town-dock-apps.nix\n- `/System/Applications/*.app`, `/Applications/*.app` - Darwin app paths\n\n## Acceptance criteria\n- [ ] Add platform conditionals or move to darwin-specific modules\n- [ ] Ensure linux equivalents exist where applicable\n- [ ] Document any Darwin-only functionality","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-14T17:40:53.864814-08:00","created_by":"gkze","updated_at":"2026-01-21T10:08:55.573185-08:00","closed_at":"2026-01-21T10:08:55.573185-08:00","close_reason":"Platform conditionals added: darwin.nix is Darwin-only file, town.nix uses runCommand without hardcoded paths, python.nix uses platform conditional for configPath","dependencies":[{"issue_id":"nixcfg-7kr","depends_on_id":"nixcfg-ugs","type":"relates-to","created_at":"2026-01-14T21:12:08.626643-08:00","created_by":"gkze"}]}
{"id":"nixcfg-9f8","title":"Add platform guard clauses in common.nix and lib.nix","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-27T15:24:10.113958-08:00","created_by":"gkze","updated_at":"2026-01-27T15:26:47.825051-08:00","closed_at":"2026-01-27T15:26:47.825051-08:00","close_reason":"Closed"}
{"id":"nixcfg-9sl","title":"Reduce machine configuration duplication","description":"**Files:** darwin/argus.nix, darwin/rocinante.nix\n\n~80% identical code. Create a parameterized base:\n\n```nix\n# darwin/default.nix\n{ hostname, extraHomeModules ? [], extraSystemModules ? [] }:\nmkSystem {\n  system = \"aarch64-darwin\";\n  users = [ \"george\" ];\n  homeModules = [ ./modules/home/macbook-pro-16in.nix ] ++ extraHomeModules;\n  systemModules = baseModules ++ extraSystemModules;\n}\n```","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-10T16:22:05.427418-08:00","created_by":"george","updated_at":"2026-01-10T16:22:05.427418-08:00"}
{"id":"nixcfg-9x7","title":"update.py: define UpdateEvent kind enum","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-19T16:19:56.604196-08:00","created_by":"gkze","updated_at":"2026-01-19T16:46:48.011896-08:00","closed_at":"2026-01-19T16:46:48.011896-08:00","close_reason":"Closed"}
{"id":"nixcfg-a2e","title":"Clean up commented code","description":"Several files have commented-out code that should be removed or documented:\n\n**Still needs cleanup:**\n- git.nix:38-42 - difftastic (replaced by delta)\n- go.nix:15-19 - go zsh plugin\n\n**Already cleaned up:**\n- ~~configuration.nix:153-167 - ghostty config~~ (now active)\n- ~~packages.nix:6 - gitbutler~~ (now active at line 32)","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-10T16:22:24.061368-08:00","created_by":"george","updated_at":"2026-01-21T10:09:06.086928-08:00"}
{"id":"nixcfg-a80","title":"Split OpenCode MCP configs by profile (work/personal)","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-27T09:18:21.119432-08:00","created_by":"gkze","updated_at":"2026-01-27T09:23:19.397251-08:00","closed_at":"2026-01-27T09:23:19.397251-08:00","close_reason":"Split MCP configs: chrome-devtools + next-devtools shared, work-only servers moved to town.nix"}
{"id":"nixcfg-abo","title":"Add NixOS support infrastructure","description":"## Summary\nThis codebase is Darwin-first and cannot build NixOS hosts. The infrastructure for cross-platform support exists in lib.nix (kernel detection, path abstractions), but NixOS-specific implementations are missing.\n\n## Critical blockers\n\n### Missing files that are imported but don't exist:\n- `modules/home/linux.nix` - required by lib.nix:86 and lib.nix:152\n- `home/george/nixos.nix` - required by home/george/configuration.nix:14\n\n### Empty/stub files:\n- `modules/nixos/base.nix` - contains only `{ }`\n\n### Missing directories:\n- `nixos/` - no directory for NixOS host configurations\n\n## Flake output limitation\nThe flake uses `flakelight-darwin` which only generates `darwinConfigurations`. Need to add `nixosConfigurations` support.\n\n## Optional optimization: Darwin-only flake inputs\nThe following flake inputs (lines 110-126) are Darwin-specific but fetched on all platforms:\n- `homebrew-core` (line 114-116)\n- `homebrew-cask` (line 110-113)\n- `macfuse` (line 122-125)\n- `pantsbuild-tap` (line 142-145)\n\nConsider making these conditional or documenting they're Darwin-only to avoid unnecessary fetches on NixOS builds.\n\n## Acceptance criteria\n- Create `modules/home/linux.nix` with systemd user services\n- Create `home/george/nixos.nix` for Linux-specific home config\n- Populate `modules/nixos/base.nix` with boot loader, systemd, etc.\n- Create `nixos/` directory structure\n- Add `nixosConfigurations` to flake outputs","status":"open","priority":1,"issue_type":"feature","owner":"george.kontridze@gmail.com","created_at":"2026-01-14T17:40:25.606689-08:00","created_by":"gkze","updated_at":"2026-01-14T21:13:07.456389-08:00","dependencies":[{"issue_id":"nixcfg-abo","depends_on_id":"nixcfg-64s","type":"blocks","created_at":"2026-01-14T17:41:17.54952-08:00","created_by":"gkze"},{"issue_id":"nixcfg-abo","depends_on_id":"nixcfg-7kr","type":"blocks","created_at":"2026-01-14T17:41:22.736449-08:00","created_by":"gkze"},{"issue_id":"nixcfg-abo","depends_on_id":"nixcfg-oba","type":"blocks","created_at":"2026-01-14T17:41:27.903901-08:00","created_by":"gkze"},{"issue_id":"nixcfg-abo","depends_on_id":"nixcfg-3to","type":"blocks","created_at":"2026-01-14T21:13:18.028622-08:00","created_by":"gkze"},{"issue_id":"nixcfg-abo","depends_on_id":"nixcfg-bbk","type":"blocks","created_at":"2026-01-14T21:13:23.206388-08:00","created_by":"gkze"}]}
{"id":"nixcfg-aev","title":"Clean up dead code and empty modules","status":"closed","priority":3,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-27T15:24:10.843198-08:00","created_by":"gkze","updated_at":"2026-01-27T15:31:03.450251-08:00","closed_at":"2026-01-27T15:31:03.450251-08:00","close_reason":"Closed"}
{"id":"nixcfg-afo","title":"Set up Hyprland + display manager modules","status":"open","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-18T01:39:09.897715-08:00","created_by":"gkze","updated_at":"2026-01-18T01:39:09.897715-08:00","dependencies":[{"issue_id":"nixcfg-afo","depends_on_id":"nixcfg-j3d","type":"blocks","created_at":"2026-01-18T01:39:21.872868-08:00","created_by":"gkze"},{"issue_id":"nixcfg-afo","depends_on_id":"nixcfg-53b","type":"discovered-from","created_at":"2026-01-18T01:39:23.012981-08:00","created_by":"gkze"},{"issue_id":"nixcfg-afo","depends_on_id":"nixcfg-eex","type":"blocks","created_at":"2026-01-18T02:49:31.360585-08:00","created_by":"gkze"}]}
{"id":"nixcfg-anl","title":"update.py: wrap rendering in Renderer class","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-19T16:19:57.122815-08:00","created_by":"gkze","updated_at":"2026-01-19T17:03:28.038932-08:00","closed_at":"2026-01-19T17:03:28.038932-08:00","close_reason":"Closed"}
{"id":"nixcfg-axe","title":"Migrate Zed to crate2nix for per-crate caching","status":"closed","priority":2,"issue_type":"feature","owner":"george.kontridze@gmail.com","created_at":"2026-01-21T14:18:34.217373-08:00","created_by":"gkze","updated_at":"2026-01-21T16:24:04.404153-08:00","closed_at":"2026-01-21T16:24:04.404153-08:00","close_reason":"ABANDONED: Based on upstream Zed PR #45543 research (jrobsonchase, closed Jan 8 2026). After 3 weeks of work, crate2nix was abandoned due to: (1) minimal caching improvement - intra-workspace deps still cause rebuilds, (2) significant eval performance hit from IFD and derivation count, (3) broken devShell - C libs not properly included, (4) crate2nix maintenance issues (11mo stale, required fork). Crane's buildDepsOnly achieves similar benefits without complexity. Recommendation: stick with Crane or rustPlatform.buildRustPackage. Reference: https://github.com/zed-industries/zed/pull/45543","dependencies":[{"issue_id":"nixcfg-axe","depends_on_id":"nixcfg-6o9","type":"blocks","created_at":"2026-01-21T14:19:19.941921-08:00","created_by":"gkze"}]}
{"id":"nixcfg-b1b","title":"Refactor home/george for cross-platform + add linux.nix","status":"open","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-18T01:39:09.992123-08:00","created_by":"gkze","updated_at":"2026-01-18T01:39:09.992123-08:00","dependencies":[{"issue_id":"nixcfg-b1b","depends_on_id":"nixcfg-afo","type":"blocks","created_at":"2026-01-18T01:39:21.985299-08:00","created_by":"gkze"},{"issue_id":"nixcfg-b1b","depends_on_id":"nixcfg-53b","type":"discovered-from","created_at":"2026-01-18T01:39:23.112777-08:00","created_by":"gkze"}]}
{"id":"nixcfg-bbk","title":"Fix mountpoint-s3 fuse dependency for cross-platform builds","description":"## Summary\nThe `mountpoint-s3` overlay in `overlays.nix:80-97` uses `fuse` as a build dependency, but the fuse package differs between macOS (macfuse) and Linux (fuse/fuse3).\n\n## Current code (overlays.nix:92)\n```nix\nbuildInputs = with prev; [ fuse ];\n```\n\n## Issue\n- On macOS, this should use macfuse (and there's already a `macfuse` flake input at line 122-125)\n- On Linux, this should use the standard `fuse` or `fuse3` package\n- Current code may fail or use wrong fuse implementation depending on platform\n\n## Fix\n```nix\nbuildInputs = with prev; [\n  (if prev.stdenv.isDarwin then macfuse else fuse3)\n];\n```\n\nOr use the existing macfuse flake input for Darwin builds.\n\n## Acceptance criteria\n- [ ] Use correct fuse package per platform\n- [ ] Test mountpoint-s3 builds on both Darwin and Linux","status":"closed","priority":2,"issue_type":"bug","owner":"george.kontridze@gmail.com","created_at":"2026-01-14T21:12:36.234574-08:00","created_by":"gkze","updated_at":"2026-01-16T13:00:38.342445-08:00","closed_at":"2026-01-16T13:00:38.342445-08:00","close_reason":"Fixed by overriding upstream mountpoint-s3 with macfuse-stubs on Darwin and fuse3 on Linux"}
{"id":"nixcfg-blq","title":"Update code-cursor to 2.3.35 in nixpkgs","description":"Nixpkgs has 2.3.29, Homebrew has 2.3.35. Update needed to migrate from Homebrew to Nixpkgs for NixOS compatibility.\n\n## Migration Instructions (Homebrew → Nix)\n\n### Option A: Nixpkgs version is sufficient\nIf nixpkgs has the version you need:\n\n1. **Check for Home Manager module**: Look for `programs.\u003cname\u003e` at https://nix-community.github.io/home-manager/options.html\n\n2. **If module exists** (preferred):\n   ```nix\n   # In home/george/configuration.nix under programs = { ... }\n   programs.\u003cname\u003e.enable = true;\n   ```\n\n3. **If no module**, check if nixpkgs has the package:\n   ```bash\n   nix eval --raw nixpkgs#\u003cname\u003e.version\n   ```\n   Then add to packages:\n   ```nix\n   # In home/george/packages.nix\n   home.packages = with pkgs; [ \u003cname\u003e ];\n   ```\n\n4. **Remove from Homebrew**: Delete from `modules/darwin/george/brew-apps.nix` (brews or casks list)\n\n5. **Rebuild**: `nh darwin switch --no-nom .`\n\n### Option B: Need newer version than nixpkgs (create overlay)\n\n1. **Add flake input** in `flake.nix`:\n   ```nix\n   \u003cname\u003e = {\n     url = \"github:\u003cowner\u003e/\u003crepo\u003e/v\u003cversion\u003e\";\n     flake = false;\n   };\n   ```\n\n2. **Create overlay** in `overlays.nix` (pattern depends on build system):\n\n   **For Rust packages (`buildRustPackage`):**\n   ```nix\n   \u003cname\u003e = prev.\u003cname\u003e.overrideAttrs {\n     version = \"\u003cversion\u003e\";\n     src = inputs.\u003cname\u003e;\n     cargoDeps = prev.rustPlatform.fetchCargoVendor {\n       src = inputs.\u003cname\u003e;\n       hash = \"\u003chash\u003e\";  # Use lib.fakeHash first, build to get correct hash\n     };\n   };\n   ```\n\n   **For npm packages (`buildNpmPackage`):**\n   ```nix\n   \u003cname\u003e = let\n     npmDepsHash = \"\u003chash\u003e\";  # Use lib.fakeHash first\n   in prev.\u003cname\u003e.overrideAttrs {\n     version = \"\u003cversion\u003e\";\n     src = inputs.\u003cname\u003e;\n     inherit npmDepsHash;\n     npmDeps = prev.fetchNpmDeps {\n       src = inputs.\u003cname\u003e;\n       hash = npmDepsHash;\n     };\n   };\n   ```\n   Note: Must override BOTH npmDepsHash AND npmDeps for npm packages.\n\n   **For Go packages (`buildGoModule`):**\n   ```nix\n   \u003cname\u003e = prev.\u003cname\u003e.overrideAttrs {\n     version = \"\u003cversion\u003e\";\n     src = inputs.\u003cname\u003e;\n     vendorHash = \"\u003chash\u003e\";  # Use lib.fakeHash first\n   };\n   ```\n\n3. **Get correct hash**: Build with `lib.fakeHash`, copy the \"got:\" hash from error\n\n4. **Update flake.lock**: `nix flake update \u003cname\u003e`\n\n5. **Continue with Option A steps** (HM module or packages, remove from Homebrew, rebuild)\n\n### Verification\n- Binary: `which \u003cname\u003e` should show `/etc/profiles/per-user/george/bin/\u003cname\u003e`\n- Version: `\u003cname\u003e --version` should show expected version","status":"closed","priority":3,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-15T22:00:35.607248-08:00","created_by":"gkze","updated_at":"2026-01-17T18:07:50.511482-08:00","closed_at":"2026-01-17T18:07:50.511482-08:00","close_reason":"Closed"}
{"id":"nixcfg-dbf","title":"Re-enable mac-app-util nixpkgs follows once SBCL on Darwin is fixed","description":"Location: flake.nix:45\n\nThe mac-app-util input has nixpkgs.follows commented out. The issue is that gitlab.common-lisp.net returns HTML (bot protection) instead of tar.gz when fetching SBCL.\n\nThis should be re-enabled once the upstream SBCL on Darwin issue is resolved.","status":"open","priority":3,"issue_type":"bug","created_at":"2026-01-10T16:15:54.891597-08:00","created_by":"george","updated_at":"2026-01-10T16:15:54.891597-08:00"}
{"id":"nixcfg-eei","title":"Implement Zed crate2nix build in overlays.nix","description":"Replace current zed-editor-nightly (uses upstream Crane) with crate2nix IFD build. Use rust-overlay with Zed's rust-toolchain.toml. Build zed and cli workspace members. Wrap with runtime deps (vulkan, wayland, etc.).","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-21T14:18:48.979112-08:00","created_by":"gkze","updated_at":"2026-01-21T16:23:59.028253-08:00","closed_at":"2026-01-21T16:23:59.028253-08:00","close_reason":"ABANDONED: Based on upstream Zed PR #45543 research (jrobsonchase, closed Jan 8 2026). After 3 weeks of work, crate2nix was abandoned due to: (1) minimal caching improvement - intra-workspace deps still cause rebuilds, (2) significant eval performance hit from IFD and derivation count, (3) broken devShell - C libs not properly included, (4) crate2nix maintenance issues (11mo stale, required fork). Crane's buildDepsOnly achieves similar benefits without complexity. Recommendation: stick with Crane or rustPlatform.buildRustPackage. Reference: https://github.com/zed-industries/zed/pull/45543","dependencies":[{"issue_id":"nixcfg-eei","depends_on_id":"nixcfg-peq","type":"blocks","created_at":"2026-01-21T14:19:18.5972-08:00","created_by":"gkze"}]}
{"id":"nixcfg-eex","title":"Research and select display manager (Ly vs greetd+tuigreet vs others)","status":"open","priority":3,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-18T02:49:25.560299-08:00","created_by":"gkze","updated_at":"2026-01-18T02:49:25.560299-08:00","dependencies":[{"issue_id":"nixcfg-eex","depends_on_id":"nixcfg-53b","type":"discovered-from","created_at":"2026-01-18T02:49:31.273239-08:00","created_by":"gkze"}]}
{"id":"nixcfg-efp","title":"update.py: refactor CLI to default-on with --no-* opt-outs","description":"Refactor update.py CLI so everything runs by default (refs + sources + input refresh). Replace --all, --update-input, --update-refs with --no-refs, --no-sources, --no-input. Unify _run_updates() to orchestrate both phases. Docstring already updated.","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-27T10:34:32.699931-08:00","created_by":"gkze","updated_at":"2026-01-27T10:40:31.091157-08:00","closed_at":"2026-01-27T10:40:31.091157-08:00","close_reason":"CLI refactored to default-on with --no-* opt-outs, unified orchestrator, both phases"}
{"id":"nixcfg-ej6","title":"update.py: add env override for panel height","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-19T16:19:57.538799-08:00","created_by":"gkze","updated_at":"2026-01-19T16:46:48.364502-08:00","closed_at":"2026-01-19T16:46:48.364502-08:00","close_reason":"Closed"}
{"id":"nixcfg-en2","title":"Update gemini-cli to 0.24.0 in nixpkgs","description":"Nixpkgs has 0.23.0, Homebrew has 0.24.0. Update needed to migrate from Homebrew to Nixpkgs for NixOS compatibility.\n\n## Migration Instructions (Homebrew → Nix)\n\nOnce nixpkgs is updated:\n\n1. **Check for Home Manager module**: Look for `programs.\u003cname\u003e` at https://nix-community.github.io/home-manager/options.html\n\n2. **If module exists** (preferred):\n   ```nix\n   # In home/george/configuration.nix under programs = { ... }\n   programs.\u003cname\u003e.enable = true;\n   ```\n\n3. **If no module**, add to packages:\n   ```nix\n   # In home/george/packages.nix\n   home.packages = with pkgs; [ \u003cname\u003e ];\n   ```\n\n4. **Uninstall from Homebrew**: `brew uninstall \u003cname\u003e`\n\n5. **Rebuild**: `nh darwin switch --no-nom .`\n\n6. **Verify**: `which \u003cname\u003e` should show `/etc/profiles/per-user/george/bin/\u003cname\u003e`","status":"closed","priority":3,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-15T22:00:33.314222-08:00","created_by":"gkze","updated_at":"2026-01-15T23:23:04.834632-08:00","closed_at":"2026-01-15T23:23:04.834632-08:00","close_reason":"Migrated gemini-cli from Homebrew to Nix via programs.gemini-cli module with overlay for 0.24.0"}
{"id":"nixcfg-far","title":"Fallback: Commit Cargo.nix files if IFD causes CI issues","description":"If IFD (Import From Derivation) causes issues in GHA workflow, generate and commit Cargo.nix files. Use conditional loading: prefer committed files in CI, use IFD locally. Low priority - only if needed.","status":"open","priority":3,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-21T14:19:09.88867-08:00","created_by":"gkze","updated_at":"2026-01-21T14:19:09.88867-08:00"}
{"id":"nixcfg-gl7","title":"Re-enable mac-app-util after SBCL 2.6.0 fix","description":"mac-app-util was temporarily disabled because SBCL 2.6.0 broke fare-quasiquote/cl-interpol readtable handling.\n\n**Upstream issue**: https://github.com/hraban/mac-app-util/issues/42\n\n**What to do**:\n1. Monitor the upstream issue for a fix\n2. Once fixed, re-enable in modules/home/darwin.nix by uncommenting the import\n3. Test with: nix build .#darwinConfigurations.argus.system\n\n**Files affected**:\n- modules/home/darwin.nix (import commented out)","status":"open","priority":3,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-25T23:07:02.908512-08:00","created_by":"gkze","updated_at":"2026-01-25T23:07:11.703921-08:00"}
{"id":"nixcfg-gpz","title":"update.py: add pseudo-TTY render regression test","status":"open","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-19T16:19:57.665229-08:00","created_by":"gkze","updated_at":"2026-01-19T16:19:57.665229-08:00"}
{"id":"nixcfg-gwe","title":"Validate and iterate OpenCode Desktop crate2nix build","description":"Build opencode-desktop with crate2nix and fix override issues. Verify Tauri bundling still works after using pre-built Rust binary. Test on macOS (native WebKit) and Linux (GTK/WebKit).","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-21T14:19:00.050872-08:00","created_by":"gkze","updated_at":"2026-01-21T16:24:04.462913-08:00","closed_at":"2026-01-21T16:24:04.462913-08:00","close_reason":"ABANDONED: Based on upstream Zed PR #45543 research (jrobsonchase, closed Jan 8 2026). After 3 weeks of work, crate2nix was abandoned due to: (1) minimal caching improvement - intra-workspace deps still cause rebuilds, (2) significant eval performance hit from IFD and derivation count, (3) broken devShell - C libs not properly included, (4) crate2nix maintenance issues (11mo stale, required fork). Crane's buildDepsOnly achieves similar benefits without complexity. Recommendation: stick with Crane or rustPlatform.buildRustPackage. Reference: https://github.com/zed-industries/zed/pull/45543","dependencies":[{"issue_id":"nixcfg-gwe","depends_on_id":"nixcfg-qzp","type":"blocks","created_at":"2026-01-21T14:19:26.276083-08:00","created_by":"gkze"}]}
{"id":"nixcfg-hdt","title":"Remove duplicate sources.json parsing in overlays.nix","status":"closed","priority":3,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-24T11:47:41.336104-08:00","created_by":"gkze","updated_at":"2026-01-24T11:48:04.57304-08:00","closed_at":"2026-01-24T11:48:04.57304-08:00","close_reason":"Now using outputs.lib.sources instead of re-parsing"}
{"id":"nixcfg-i1u","title":"Consolidate theme configuration","description":"Theme (Catppuccin Frappe) is configured in multiple places:\n\n- stylix.nix:7 - base theme\n- nixvim.nix:67-99 - explicit colorscheme\n- configuration.nix:112-116 - bat theme\n- git.nix:49 - delta theme\n\n**Fix:** Create single theme.nix module with variables other modules reference","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T16:21:39.079524-08:00","created_by":"george","updated_at":"2026-01-10T16:21:39.079524-08:00"}
{"id":"nixcfg-i2p","title":"Document disabled features","description":"Several features are disabled without explanation:\n\n**Needs documentation:**\n- stylix.nix: bat.enable = false, nixvim.enable = false, vscode.enable = false (no comments)\n- nixvim.nix:655: kulala plugin commented out (no explanation)\n- configuration.nix: zellij enableZshIntegration = false (no comment)\n\n**Already documented:**\n- ~~nixvim.nix:677 - spectre_oxi~~ (has TODO comment explaining build issue)\n\nAdd comments explaining *why* each is disabled.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-10T16:22:05.561622-08:00","created_by":"george","updated_at":"2026-01-27T09:30:58.326908-08:00","closed_at":"2026-01-27T09:30:58.326908-08:00","close_reason":"All disabled features already have explanatory comments: stylix bat/nixvim/vscode, nixvim kulala, zellij zsh integration"}
{"id":"nixcfg-j3d","title":"Create modules/nixos/base.nix with common NixOS settings","status":"open","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-18T01:39:09.526031-08:00","created_by":"gkze","updated_at":"2026-01-18T01:39:09.526031-08:00","dependencies":[{"issue_id":"nixcfg-j3d","depends_on_id":"nixcfg-tmh","type":"blocks","created_at":"2026-01-18T01:39:21.162419-08:00","created_by":"gkze"},{"issue_id":"nixcfg-j3d","depends_on_id":"nixcfg-53b","type":"discovered-from","created_at":"2026-01-18T01:39:22.540703-08:00","created_by":"gkze"}]}
{"id":"nixcfg-kia","title":"Move inline overlays from flake.nix to overlays.nix","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-27T15:24:09.446406-08:00","created_by":"gkze","updated_at":"2026-01-27T15:25:58.782687-08:00","closed_at":"2026-01-27T15:25:58.782687-08:00","close_reason":"Closed"}
{"id":"nixcfg-lpo","title":"DRY: Extract shared dock apps to reduce duplication","status":"closed","priority":3,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-24T11:47:40.001247-08:00","created_by":"gkze","updated_at":"2026-01-24T11:51:33.627198-08:00","closed_at":"2026-01-24T11:51:33.627198-08:00","close_reason":"Not worth abstracting - dock app ordering is intentional and explicit lists are more readable than any abstraction"}
{"id":"nixcfg-msj","title":"Implement secrets management","description":"**Current State:** No encryption; metadata in plain text (meta.nix)\n\n**Recommended:** Implement agenix or sops-nix:\n\n```nix\n# Example with agenix\nage.secrets.gpgKey.file = ../secrets/gpg-key.age;\nprograms.gpg.settings.default-key = config.age.secrets.gpgKey.path;\n```","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-10T16:21:38.947357-08:00","created_by":"george","updated_at":"2026-01-21T10:08:54.028473-08:00","closed_at":"2026-01-21T10:08:54.028473-08:00","close_reason":"sops-nix is configured in flake.nix (lines 85-88), imported in lib.nix (line 175), and referenced in home/george/configuration.nix"}
{"id":"nixcfg-mw2","title":"Update vscode to 1.108.1+ in nixpkgs","description":"Nixpkgs has 1.107.1 (stable), Homebrew has 1.108.1 (stable) / 1.109.0 (insiders). Update needed to migrate from Homebrew to Nixpkgs for NixOS compatibility.\n\n## Migration Instructions (Homebrew → Nix)\n\n### Option A: Nixpkgs version is sufficient\nIf nixpkgs has the version you need:\n\n1. **Check for Home Manager module**: Look for `programs.\u003cname\u003e` at https://nix-community.github.io/home-manager/options.html\n\n2. **If module exists** (preferred):\n   ```nix\n   # In home/george/configuration.nix under programs = { ... }\n   programs.\u003cname\u003e.enable = true;\n   ```\n\n3. **If no module**, check if nixpkgs has the package:\n   ```bash\n   nix eval --raw nixpkgs#\u003cname\u003e.version\n   ```\n   Then add to packages:\n   ```nix\n   # In home/george/packages.nix\n   home.packages = with pkgs; [ \u003cname\u003e ];\n   ```\n\n4. **Remove from Homebrew**: Delete from `modules/darwin/george/brew-apps.nix` (brews or casks list)\n\n5. **Rebuild**: `nh darwin switch --no-nom .`\n\n### Option B: Need newer version than nixpkgs (create overlay)\n\n1. **Add flake input** in `flake.nix`:\n   ```nix\n   \u003cname\u003e = {\n     url = \"github:\u003cowner\u003e/\u003crepo\u003e/v\u003cversion\u003e\";\n     flake = false;\n   };\n   ```\n\n2. **Create overlay** in `overlays.nix` (pattern depends on build system):\n\n   **For Rust packages (`buildRustPackage`):**\n   ```nix\n   \u003cname\u003e = prev.\u003cname\u003e.overrideAttrs {\n     version = \"\u003cversion\u003e\";\n     src = inputs.\u003cname\u003e;\n     cargoDeps = prev.rustPlatform.fetchCargoVendor {\n       src = inputs.\u003cname\u003e;\n       hash = \"\u003chash\u003e\";  # Use lib.fakeHash first, build to get correct hash\n     };\n   };\n   ```\n\n   **For npm packages (`buildNpmPackage`):**\n   ```nix\n   \u003cname\u003e = let\n     npmDepsHash = \"\u003chash\u003e\";  # Use lib.fakeHash first\n   in prev.\u003cname\u003e.overrideAttrs {\n     version = \"\u003cversion\u003e\";\n     src = inputs.\u003cname\u003e;\n     inherit npmDepsHash;\n     npmDeps = prev.fetchNpmDeps {\n       src = inputs.\u003cname\u003e;\n       hash = npmDepsHash;\n     };\n   };\n   ```\n   Note: Must override BOTH npmDepsHash AND npmDeps for npm packages.\n\n   **For Go packages (`buildGoModule`):**\n   ```nix\n   \u003cname\u003e = prev.\u003cname\u003e.overrideAttrs {\n     version = \"\u003cversion\u003e\";\n     src = inputs.\u003cname\u003e;\n     vendorHash = \"\u003chash\u003e\";  # Use lib.fakeHash first\n   };\n   ```\n\n3. **Get correct hash**: Build with `lib.fakeHash`, copy the \"got:\" hash from error\n\n4. **Update flake.lock**: `nix flake update \u003cname\u003e`\n\n5. **Continue with Option A steps** (HM module or packages, remove from Homebrew, rebuild)\n\n### Verification\n- Binary: `which \u003cname\u003e` should show `/etc/profiles/per-user/george/bin/\u003cname\u003e`\n- Version: `\u003cname\u003e --version` should show expected version","status":"closed","priority":3,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-15T22:00:37.10709-08:00","created_by":"gkze","updated_at":"2026-01-15T23:40:23.115155-08:00","closed_at":"2026-01-15T23:40:23.115155-08:00","close_reason":"Migrated to VS Code Insiders (1.109.0-insider) via overlay instead of stable. Used programs.vscode Home Manager module with custom vscode-insiders package from overlay. Removed visual-studio-code@insiders from Homebrew casks."}
{"id":"nixcfg-nwh","title":"Set up SOPS age key for ceres","status":"open","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-18T01:39:10.085827-08:00","created_by":"gkze","updated_at":"2026-01-18T01:39:10.085827-08:00","dependencies":[{"issue_id":"nixcfg-nwh","depends_on_id":"nixcfg-53b","type":"discovered-from","created_at":"2026-01-18T01:39:23.22118-08:00","created_by":"gkze"}]}
{"id":"nixcfg-oba","title":"Add NixOS equivalents for Darwin system services","description":"## Summary\nDarwin-specific system services using launchd need NixOS equivalents using systemd.\n\n## Current Darwin services (modules/darwin/base.nix)\n\n### launchd.daemons.maxfiles\nIncreases file descriptor limits. NixOS equivalent:\n```nix\nboot.kernel.sysctl = {\n  \"fs.file-max\" = 1048576;\n};\n# Or systemd-based approach\n```\n\n### launchd.daemons.maxproc\nIncreases process limits. NixOS equivalent via sysctl or limits.conf.\n\n## Current Darwin user services (home/george/darwin.nix)\n\n### launchd.agents.ssh-add\nLoads SSH keys into keychain. NixOS equivalent:\n```nix\nservices.ssh-agent.enable = true;\n# Or systemd user service\n```\n\n### launchd.agents.gpg-agent\nGPG agent service. NixOS equivalent:\n```nix\nservices.gpg-agent = {\n  enable = true;\n  enableSshSupport = true;\n};\n```\n\n## Acceptance criteria\n- [ ] Create systemd equivalents in modules/nixos/base.nix\n- [ ] Create user service equivalents in modules/home/linux.nix\n- [ ] Test service functionality on NixOS","status":"open","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-14T17:41:07.428186-08:00","created_by":"gkze","updated_at":"2026-01-14T17:41:07.428186-08:00"}
{"id":"nixcfg-oey","title":"Create nixos/ceres.nix host configuration","status":"open","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-18T01:39:09.804928-08:00","created_by":"gkze","updated_at":"2026-01-18T01:39:09.804928-08:00","dependencies":[{"issue_id":"nixcfg-oey","depends_on_id":"nixcfg-j3d","type":"blocks","created_at":"2026-01-18T01:39:21.535244-08:00","created_by":"gkze"},{"issue_id":"nixcfg-oey","depends_on_id":"nixcfg-wxu","type":"blocks","created_at":"2026-01-18T01:39:21.649862-08:00","created_by":"gkze"},{"issue_id":"nixcfg-oey","depends_on_id":"nixcfg-370","type":"blocks","created_at":"2026-01-18T01:39:21.755722-08:00","created_by":"gkze"},{"issue_id":"nixcfg-oey","depends_on_id":"nixcfg-53b","type":"discovered-from","created_at":"2026-01-18T01:39:22.883681-08:00","created_by":"gkze"}]}
{"id":"nixcfg-os2","title":"Add input documentation to flake.nix","description":"**File:** flake.nix\n\n28 non-flake inputs lack explanation. Add comments:\n\n```nix\n# Vim plugins not available in nixpkgs\nzsh-system-clipboard = { url = \"...\"; flake = false; };\n```","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-10T16:22:24.184322-08:00","created_by":"george","updated_at":"2026-01-10T16:22:24.184322-08:00"}
{"id":"nixcfg-peq","title":"Create Zed-specific crate overrides","description":"Create overrides for Zed-specific crates: webrtc-sys (livekit-libwebrtc + patch static-\u003edylib), gpui (vulkan/wayland/X11/Metal), cpal/rodio (alsa-lib), wayland-* crates, xkbcommon, x11rb, blade-graphics, zed-scap, ashpd. Extends shared overrides.","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-21T14:18:47.030684-08:00","created_by":"gkze","updated_at":"2026-01-21T14:26:02.431952-08:00","closed_at":"2026-01-21T14:26:02.431952-08:00","close_reason":"Created Zed-specific overrides in nix/crate-overrides/zed.nix with 27 crate overrides including gpui, webrtc-sys, blade-graphics, cpal/rodio, wayland-*, xkbcommon, x11rb, ashpd, zed-scap, sqlite, vulkan, and Darwin frameworks","dependencies":[{"issue_id":"nixcfg-peq","depends_on_id":"nixcfg-wpz","type":"blocks","created_at":"2026-01-21T14:19:18.102362-08:00","created_by":"gkze"}]}
{"id":"nixcfg-qec","title":"Split monolithic overlays.nix (226 lines)","description":"**File:** overlays.nix\n\nCurrently mixes Go, Python, Rust, and Vim plugins. Recommended:\n\n```\noverlays/\n├── default.nix        # Imports all overlays\n├── go-packages.nix    # beads, stars\n├── python-packages.nix # beads-mcp, toad\n├── vim-plugins.nix    # treesitter overrides, codesnap\n└── utils.nix          # homebrew-zsh-completion, mountpoint-s3\n```","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T16:21:38.81746-08:00","created_by":"george","updated_at":"2026-01-10T16:21:38.81746-08:00","dependencies":[{"issue_id":"nixcfg-qec","depends_on_id":"nixcfg-3to","type":"relates-to","created_at":"2026-01-14T21:13:28.380939-08:00","created_by":"gkze"}]}
{"id":"nixcfg-qzp","title":"Implement OpenCode Desktop hybrid crate2nix/Tauri build","description":"Create hybrid build: 1) Build Tauri Rust backend with crate2nix for per-crate caching, 2) Build frontend with Bun (unchanged), 3) Integrate with cargo-tauri bundling. The CLI sidecar is TypeScript so stays as-is.","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-21T14:18:58.369537-08:00","created_by":"gkze","updated_at":"2026-01-21T16:24:04.444769-08:00","closed_at":"2026-01-21T16:24:04.444769-08:00","close_reason":"ABANDONED: Based on upstream Zed PR #45543 research (jrobsonchase, closed Jan 8 2026). After 3 weeks of work, crate2nix was abandoned due to: (1) minimal caching improvement - intra-workspace deps still cause rebuilds, (2) significant eval performance hit from IFD and derivation count, (3) broken devShell - C libs not properly included, (4) crate2nix maintenance issues (11mo stale, required fork). Crane's buildDepsOnly achieves similar benefits without complexity. Recommendation: stick with Crane or rustPlatform.buildRustPackage. Reference: https://github.com/zed-industries/zed/pull/45543","dependencies":[{"issue_id":"nixcfg-qzp","depends_on_id":"nixcfg-2n7","type":"blocks","created_at":"2026-01-21T14:19:25.666305-08:00","created_by":"gkze"}]}
{"id":"nixcfg-rat","title":"Fix typo: brew-zsh-compmletion -\u003e completion","status":"closed","priority":2,"issue_type":"bug","owner":"george.kontridze@gmail.com","created_at":"2026-01-24T11:47:40.70802-08:00","created_by":"gkze","updated_at":"2026-01-24T11:48:03.314033-08:00","closed_at":"2026-01-24T11:48:03.314033-08:00","close_reason":"Fixed typo in overlays.nix"}
{"id":"nixcfg-s0l","title":"Parameterize hardware-specific values","description":"**File:** modules/home/macbook-pro-16in.nix:2-12\n\n```nix\ndimensions = { columns = 250; lines = 80; };\nposition = { x = 433; y = 400; };\n```\n\n- Magic numbers not portable across displays\n- **Fix:** Make configurable via module options or remove","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-10T16:22:05.975329-08:00","created_by":"george","updated_at":"2026-01-10T16:22:05.975329-08:00"}
{"id":"nixcfg-s2b","title":"Update zed-editor to 0.219.4 in nixpkgs","description":"Nixpkgs has 0.219.4, Homebrew has 0.219.4. Versions are now in sync.\n\n## Current State\n\nThe overlay in `overlays.nix` (lines 523-560) is commented out. The nixpkgs derivation has been updated to 0.219.4 (see https://github.com/NixOS/nixpkgs/blob/nixos-unstable/pkgs/by-name/ze/zed-editor/package.nix).\n\n## Technical Analysis\n\n### Nixpkgs Derivation (package.nix)\n- **Build system**: `rustPlatform.buildRustPackage`\n- **Version**: 0.219.4\n- **cargoHash**: `sha256-adHfP57EpqCOo8HSpuG1JTV6qNljz282PYgR32cCuxE=`\n- **Key workarounds**:\n  - `depsExtraArgs.postBuild` removes `candle-book/` from vendored deps (broken Cargo.toml)\n  - Patches `webrtc-sys` build.rs to use dynamic linking (`dylib=webrtc` instead of `static=webrtc`)\n  - Uses `cargo-bundle` for macOS app bundling with custom plist handling\n  - `buildFeatures` includes `gpui/runtime_shaders` on Darwin (no Metal shader compiler in Nix)\n  \n### Zed In-Repo Flake (nix/build.nix)\n- **Build system**: Crane (`craneLib.buildPackage`)\n- **Version**: Dynamic from `crates/zed/Cargo.toml` + \"-nightly\" suffix\n- **Key differences from nixpkgs**:\n  - Uses Crane for incremental builds with `buildDepsOnly`\n  - Pins `cargo-about` to 0.8.2 (newer versions incompatible with license identifiers)\n  - Uses Zed's fork of `cargo-bundle` (zed-industries/cargo-bundle)\n  - Uses `mold` linker on Linux via `useMoldLinker`\n  - Has binary caching via Cachix (`zed.cachix.org`)\n  - App is named \"Zed Nightly\" on Darwin\n  \n### Why Overlay Was Disabled\n\nThe overlay attempted simple `overrideAttrs` to pin a newer version but encountered:\n1. **Cargo.lock issues**: Some crates appear from both crates.io AND git, causing \"File exists\" errors during vendor\n2. **candle-book workaround**: Needed `postBuild` in `depsExtraArgs` to remove broken Cargo.toml\n\n### Migration Options\n\n**Option A: Use nixpkgs directly (Recommended)**\nSince nixpkgs is now at 0.219.4:\n1. Check for Home Manager module: `programs.zed-editor` exists in home-manager\n2. Enable it: `programs.zed-editor.enable = true;`\n3. Or add to packages: `home.packages = with pkgs; [ zed-editor ];`\n4. Remove from Homebrew casks in `modules/darwin/george/brew-apps.nix`\n5. Rebuild: `nh darwin switch --no-nom .`\n\n**Option B: Use Zed's in-repo flake (for nightly/preview)**\n```nix\n# flake.nix inputs\nzed = {\n  url = \"github:zed-industries/zed\";\n  inputs.nixpkgs.follows = \"nixpkgs\";\n};\n\n# Use zed.packages.${system}.default\n```\nBenefits: Crane caching, nightly builds, Cachix binary cache\n\n**Option C: Fix overlay for pinned version**\nWould require:\n1. Using `depsExtraArgs.postBuild` to remove candle-book\n2. Potentially Cargo.lock deduplication (like gitbutler overlay)\n3. Matching cargoHash for the specific version","status":"closed","priority":3,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-15T22:00:34.290022-08:00","created_by":"gkze","updated_at":"2026-01-17T22:28:15.923514-08:00","closed_at":"2026-01-17T22:28:15.923514-08:00","close_reason":"Closed"}
{"id":"nixcfg-s7o","title":"Remove 14 unused flake inputs","description":"## Audit Results\n\nThe following 14 flake inputs are declared but never used:\n\n| Input | Reason Unused |\n|-------|---------------|\n| nixos-hardware | No NixOS systems defined - only Darwin hosts |\n| nix-rosetta-builder | Never referenced in codebase |\n| firefox | Nightly overlay not integrated anywhere |\n| rust-overlay | Unused - rustup from nixpkgs used instead |\n| bufresize-nvim | Not in nixvim config despite being declared |\n| kdl-vim | Not used - sublime-kdl used for bat syntax instead |\n| macfuse | Homebrew cask 'macfuse' is used, not this input |\n| markdown-table-formatter | Formatter uses nixpkgs mdformat, not this |\n| mdq | Uses pkgs.mdq from nixpkgs, not input |\n| mountpoint-s3 | Overrides nixpkgs package, input source unused |\n| naersk | Rust build framework not referenced |\n| tclint | TCL linter never integrated |\n| treewalker-nvim | Uses pkgs.vimPlugins.treewalker-nvim from nixpkgs |\n| zsh-completions | Not referenced - completions from other sources |\n\n## Action\nRemove these inputs from flake.nix to reduce lock file size and update times.","status":"open","priority":3,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-20T09:35:09.7967-08:00","created_by":"gkze","updated_at":"2026-01-20T09:35:23.476132-08:00"}
{"id":"nixcfg-sq5","title":"Clean up commented-out dead code","status":"open","priority":4,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-24T11:47:41.991884-08:00","created_by":"gkze","updated_at":"2026-01-24T11:47:41.991884-08:00"}
{"id":"nixcfg-t82","title":"Add package categories to packages.nix","description":"**File:** home/george/packages.nix\n\n80+ packages with no organization. Add comment sections:\n\n```nix\nhome.packages = with pkgs; [\n  # === CLI Tools ===\n  bat bottom eza fd fzf ripgrep\n\n  # === Development ===\n  git-lfs gh gitui\n\n  # === TUI Applications ===\n  yazi lazygit\n\n  # === Languages ===\n  nodejs bun\n];\n```","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-10T16:22:23.935173-08:00","created_by":"george","updated_at":"2026-01-10T16:22:23.935173-08:00"}
{"id":"nixcfg-tfh","title":"Split large nixvim.nix (902 lines)","description":"**File:** home/george/nixvim.nix\n\nThe file is too large to maintain effectively. Recommended split:\n\n```\nhome/george/nixvim/\n├── default.nix       # Main entry, imports all\n├── plugins.nix       # Plugin configurations (~400 lines)\n├── keymaps.nix       # Keybindings (~130 lines)\n├── lsp.nix           # LSP servers (~100 lines)\n├── colorscheme.nix   # Theme settings\n└── autocmds.nix      # Autocommands\n```","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T16:21:38.687731-08:00","created_by":"george","updated_at":"2026-01-10T16:21:38.687731-08:00"}
{"id":"nixcfg-tmh","title":"Add disko, nixos-hardware, impermanence inputs to flake","description":"Add required flake inputs for NixOS deployment:\n\n**Already added:**\n- ~~nixos-hardware~~ (present at line 6)\n\n**Still needed:**\n- disko - declarative disk partitioning\n- impermanence - for ephemeral root setup","status":"open","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-18T01:39:09.432618-08:00","created_by":"gkze","updated_at":"2026-01-21T10:09:19.203832-08:00","dependencies":[{"issue_id":"nixcfg-tmh","depends_on_id":"nixcfg-53b","type":"discovered-from","created_at":"2026-01-18T01:39:22.439407-08:00","created_by":"gkze"}]}
{"id":"nixcfg-tsc","title":"update.py: consider stable JSON save ordering","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-19T16:19:57.021272-08:00","created_by":"gkze","updated_at":"2026-01-19T16:46:48.470303-08:00","closed_at":"2026-01-19T16:46:48.470303-08:00","close_reason":"Closed"}
{"id":"nixcfg-uec","title":"GitButler Nix build: complex git dep handling needed","description":"## Summary\nGitButler 0.18.6 has complex Cargo dependencies that make Nix builds challenging. The main issue is duplicate crate sources (same version from both git and crates.io) which causes cargo vendor conflicts.\n\n## Key Findings\n\n### 1. Gitoxide Crates Duplication\nGitButler uses gitoxide crates from `git+https://github.com/GitoxideLabs/gitoxide?branch=main`, but the same versions exist on crates.io. This causes 'File exists' errors during cargo vendor.\n\n**Solution developed**: Created `misc/dedup_cargo_lock.py` that:\n- Converts 53 gitoxide git sources to crates.io (with embedded checksums)\n- Removes 20 duplicate packages\n- Fixes dependency references in Cargo.lock\n\n### 2. Additional Git Dependencies\nBeyond gitoxide, GitButler has:\n- `file-id` from `notify-rs/notify` git repo (also on crates.io)\n- `tauri-plugin-trafficlights-positioner` from git\n\nBoth Cargo.lock AND Cargo.toml files need patching to remove git refs.\n\n### 3. Tauri Build Script Issues\nThe `tauri-before-build-command.sh` runs `cargo build` which tries to fetch git repos even in Nix sandbox. Options:\n- Use `--offline` flag (requires vendored git deps to be configured)\n- Skip the cargo build (but then inject-git-binaries.sh fails)\n\n### 4. Cargo Vendor Config Gap\nEven with `--offline`, cargo looks for git sources not in the vendor config. The vendor config only maps some git deps, not all.\n\n## Files Modified (to be reverted)\n- `overlays.nix`: GitButler overlay with patching\n- `misc/dedup_cargo_lock.py`: Cargo.lock dedup script (keep for reference)\n\n## Recommendation\nUse Homebrew cask for GitButler on macOS. Revisit Nix packaging when:\n1. GitButler upstream removes git deps for crates on crates.io\n2. Or nixpkgs catches up to 0.18.x with working patches\n\n## Reference\nnixpkgs 0.15.10 uses a 3000+ line `gix-from-crates-io.patch` to handle this.","status":"open","priority":4,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-22T13:01:17.60179-08:00","created_by":"gkze","updated_at":"2026-01-22T13:01:37.237262-08:00"}
{"id":"nixcfg-uey","title":"Create deployment script with disk selection","status":"open","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-18T01:39:10.267542-08:00","created_by":"gkze","updated_at":"2026-01-18T01:39:10.267542-08:00","dependencies":[{"issue_id":"nixcfg-uey","depends_on_id":"nixcfg-vxb","type":"blocks","created_at":"2026-01-18T01:39:22.296162-08:00","created_by":"gkze"},{"issue_id":"nixcfg-uey","depends_on_id":"nixcfg-53b","type":"discovered-from","created_at":"2026-01-18T01:39:23.451986-08:00","created_by":"gkze"}]}
{"id":"nixcfg-ugs","title":"Fix hardcoded 1Password path","description":"**File:** modules/home/town.nix:16\n\n```nix\nHOME=$(mktemp -d) /opt/homebrew/bin/op completion zsh \u003e $out/_op\n```\n\n**Risk:** Breaks on Intel Macs (/usr/local/bin) or if 1Password not installed\n**Fix:** Use pkgs._1password or make conditional with lib.optionalAttrs","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-10T16:21:14.264723-08:00","created_by":"george","updated_at":"2026-01-17T22:32:45.479867-08:00","closed_at":"2026-01-17T22:32:45.479867-08:00","close_reason":"Fixed: SSH uses accept-new, removed global allowInsecure, 1Password uses nix pkg","dependencies":[{"issue_id":"nixcfg-ugs","depends_on_id":"nixcfg-7kr","type":"relates-to","created_at":"2026-01-14T21:12:08.627142-08:00","created_by":"gkze"}]}
{"id":"nixcfg-vxb","title":"Create installer ISO configuration","status":"open","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-18T01:39:10.177163-08:00","created_by":"gkze","updated_at":"2026-01-18T01:39:10.177163-08:00","dependencies":[{"issue_id":"nixcfg-vxb","depends_on_id":"nixcfg-oey","type":"blocks","created_at":"2026-01-18T01:39:22.086691-08:00","created_by":"gkze"},{"issue_id":"nixcfg-vxb","depends_on_id":"nixcfg-nwh","type":"blocks","created_at":"2026-01-18T01:39:22.189358-08:00","created_by":"gkze"},{"issue_id":"nixcfg-vxb","depends_on_id":"nixcfg-53b","type":"discovered-from","created_at":"2026-01-18T01:39:23.322565-08:00","created_by":"gkze"}]}
{"id":"nixcfg-wba","title":"Update gitbutler to 0.18.3 in nixpkgs","description":"Nixpkgs has 0.15.10, Homebrew has 0.18.3. Significant version gap. Update needed to migrate from Homebrew to Nixpkgs for NixOS compatibility.\n\n## Migration Instructions (Homebrew → Nix)\n\n### Option A: Nixpkgs version is sufficient\nIf nixpkgs has the version you need:\n\n1. **Check for Home Manager module**: Look for `programs.\u003cname\u003e` at https://nix-community.github.io/home-manager/options.html\n\n2. **If module exists** (preferred):\n   ```nix\n   # In home/george/configuration.nix under programs = { ... }\n   programs.\u003cname\u003e.enable = true;\n   ```\n\n3. **If no module**, check if nixpkgs has the package:\n   ```bash\n   nix eval --raw nixpkgs#\u003cname\u003e.version\n   ```\n   Then add to packages:\n   ```nix\n   # In home/george/packages.nix\n   home.packages = with pkgs; [ \u003cname\u003e ];\n   ```\n\n4. **Remove from Homebrew**: Delete from `modules/darwin/george/brew-apps.nix` (brews or casks list)\n\n5. **Rebuild**: `nh darwin switch --no-nom .`\n\n### Option B: Need newer version than nixpkgs (create overlay)\n\n1. **Add flake input** in `flake.nix`:\n   ```nix\n   \u003cname\u003e = {\n     url = \"github:\u003cowner\u003e/\u003crepo\u003e/v\u003cversion\u003e\";\n     flake = false;\n   };\n   ```\n\n2. **Create overlay** in `overlays.nix` (pattern depends on build system):\n\n   **For Rust packages (`buildRustPackage`):**\n   ```nix\n   \u003cname\u003e = prev.\u003cname\u003e.overrideAttrs {\n     version = \"\u003cversion\u003e\";\n     src = inputs.\u003cname\u003e;\n     cargoDeps = prev.rustPlatform.fetchCargoVendor {\n       src = inputs.\u003cname\u003e;\n       hash = \"\u003chash\u003e\";  # Use lib.fakeHash first, build to get correct hash\n     };\n   };\n   ```\n\n   **For npm packages (`buildNpmPackage`):**\n   ```nix\n   \u003cname\u003e = let\n     npmDepsHash = \"\u003chash\u003e\";  # Use lib.fakeHash first\n   in prev.\u003cname\u003e.overrideAttrs {\n     version = \"\u003cversion\u003e\";\n     src = inputs.\u003cname\u003e;\n     inherit npmDepsHash;\n     npmDeps = prev.fetchNpmDeps {\n       src = inputs.\u003cname\u003e;\n       hash = npmDepsHash;\n     };\n   };\n   ```\n   Note: Must override BOTH npmDepsHash AND npmDeps for npm packages.\n\n   **For Go packages (`buildGoModule`):**\n   ```nix\n   \u003cname\u003e = prev.\u003cname\u003e.overrideAttrs {\n     version = \"\u003cversion\u003e\";\n     src = inputs.\u003cname\u003e;\n     vendorHash = \"\u003chash\u003e\";  # Use lib.fakeHash first\n   };\n   ```\n\n3. **Get correct hash**: Build with `lib.fakeHash`, copy the \"got:\" hash from error\n\n4. **Update flake.lock**: `nix flake update \u003cname\u003e`\n\n5. **Continue with Option A steps** (HM module or packages, remove from Homebrew, rebuild)\n\n### Verification\n- Binary: `which \u003cname\u003e` should show `/etc/profiles/per-user/george/bin/\u003cname\u003e`\n- Version: `\u003cname\u003e --version` should show expected version","status":"closed","priority":3,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-15T22:00:34.857454-08:00","created_by":"gkze","updated_at":"2026-01-16T11:30:36.852463-08:00","closed_at":"2026-01-16T11:30:36.852463-08:00","close_reason":"Migrated GitButler from Homebrew to Nix overlay with version 0.18.3. Created dedup_cargo_lock.py script to handle duplicate Cargo.lock sources."}
{"id":"nixcfg-wd2","title":"DRY up darwin host declarations","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-27T13:47:46.202578-08:00","created_by":"gkze","updated_at":"2026-01-27T13:55:57.969966-08:00","closed_at":"2026-01-27T13:55:57.969966-08:00","close_reason":"Added mkDarwinHost helper to lib.nix; simplified rocinante.nix and argus.nix to use it"}
{"id":"nixcfg-wpz","title":"Create shared crate-overrides for common Rust crates","description":"Create reusable crate overrides for common dependencies: ring (perl), zstd-sys, openssl-sys, prost-build (protobuf), libgit2-sys, fontconfig-sys, freetype-sys. These will be shared between Zed and OpenCode Desktop builds.","status":"closed","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-21T14:18:41.961351-08:00","created_by":"gkze","updated_at":"2026-01-21T14:23:56.648914-08:00","closed_at":"2026-01-21T14:23:56.648914-08:00","close_reason":"Created shared crate overrides in nix/crate-overrides/{shared,default}.nix with overrides for ring, zstd-sys, openssl-sys, prost-build, libgit2-sys, fontconfig-sys, freetype-sys, curl-sys, libssh2-sys, bzip2-sys, lzma-sys"}
{"id":"nixcfg-wxu","title":"Create nixos/disko/ceres.nix with btrfs+LUKS layout","status":"open","priority":2,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-18T01:39:09.624432-08:00","created_by":"gkze","updated_at":"2026-01-18T01:39:09.624432-08:00","dependencies":[{"issue_id":"nixcfg-wxu","depends_on_id":"nixcfg-tmh","type":"blocks","created_at":"2026-01-18T01:39:21.263995-08:00","created_by":"gkze"},{"issue_id":"nixcfg-wxu","depends_on_id":"nixcfg-53b","type":"discovered-from","created_at":"2026-01-18T01:39:22.636946-08:00","created_by":"gkze"}]}
{"id":"nixcfg-x2z","title":"Consolidate dock configuration","description":"**Files:**\n- modules/darwin/george/dock-apps.nix (24 lines)\n- modules/darwin/george/town-dock-apps.nix (27 lines)\n\n85% overlap. Merge into single parametrized module:\n\n```nix\n{ config, lib, ... }: {\n  options.dock.extraApps = lib.mkOption { default = []; };\n  config.system.defaults.dock.persistent-apps =\n    baseApps ++ config.dock.extraApps;\n}\n```","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-10T16:22:05.704935-08:00","created_by":"george","updated_at":"2026-01-10T16:22:05.704935-08:00"}
{"id":"nixcfg-z40","title":"Update datagrip to 2025.3.3 in nixpkgs","description":"Nixpkgs has 2025.3.2, Homebrew has 2025.3.3. Update needed to migrate from Homebrew to Nixpkgs for NixOS compatibility.\n\n## Migration Instructions (Homebrew → Nix)\n\n### Option A: Nixpkgs version is sufficient\nIf nixpkgs has the version you need:\n\n1. **Check for Home Manager module**: Look for `programs.\u003cname\u003e` at https://nix-community.github.io/home-manager/options.html\n\n2. **If module exists** (preferred):\n   ```nix\n   # In home/george/configuration.nix under programs = { ... }\n   programs.\u003cname\u003e.enable = true;\n   ```\n\n3. **If no module**, check if nixpkgs has the package:\n   ```bash\n   nix eval --raw nixpkgs#\u003cname\u003e.version\n   ```\n   Then add to packages:\n   ```nix\n   # In home/george/packages.nix\n   home.packages = with pkgs; [ \u003cname\u003e ];\n   ```\n\n4. **Remove from Homebrew**: Delete from `modules/darwin/george/brew-apps.nix` (brews or casks list)\n\n5. **Rebuild**: `nh darwin switch --no-nom .`\n\n### Option B: Need newer version than nixpkgs (create overlay)\n\n1. **Add flake input** in `flake.nix`:\n   ```nix\n   \u003cname\u003e = {\n     url = \"github:\u003cowner\u003e/\u003crepo\u003e/v\u003cversion\u003e\";\n     flake = false;\n   };\n   ```\n\n2. **Create overlay** in `overlays.nix` (pattern depends on build system):\n\n   **For Rust packages (`buildRustPackage`):**\n   ```nix\n   \u003cname\u003e = prev.\u003cname\u003e.overrideAttrs {\n     version = \"\u003cversion\u003e\";\n     src = inputs.\u003cname\u003e;\n     cargoDeps = prev.rustPlatform.fetchCargoVendor {\n       src = inputs.\u003cname\u003e;\n       hash = \"\u003chash\u003e\";  # Use lib.fakeHash first, build to get correct hash\n     };\n   };\n   ```\n\n   **For npm packages (`buildNpmPackage`):**\n   ```nix\n   \u003cname\u003e = let\n     npmDepsHash = \"\u003chash\u003e\";  # Use lib.fakeHash first\n   in prev.\u003cname\u003e.overrideAttrs {\n     version = \"\u003cversion\u003e\";\n     src = inputs.\u003cname\u003e;\n     inherit npmDepsHash;\n     npmDeps = prev.fetchNpmDeps {\n       src = inputs.\u003cname\u003e;\n       hash = npmDepsHash;\n     };\n   };\n   ```\n   Note: Must override BOTH npmDepsHash AND npmDeps for npm packages.\n\n   **For Go packages (`buildGoModule`):**\n   ```nix\n   \u003cname\u003e = prev.\u003cname\u003e.overrideAttrs {\n     version = \"\u003cversion\u003e\";\n     src = inputs.\u003cname\u003e;\n     vendorHash = \"\u003chash\u003e\";  # Use lib.fakeHash first\n   };\n   ```\n\n3. **Get correct hash**: Build with `lib.fakeHash`, copy the \"got:\" hash from error\n\n4. **Update flake.lock**: `nix flake update \u003cname\u003e`\n\n5. **Continue with Option A steps** (HM module or packages, remove from Homebrew, rebuild)\n\n### Verification\n- Binary: `which \u003cname\u003e` should show `/etc/profiles/per-user/george/bin/\u003cname\u003e`\n- Version: `\u003cname\u003e --version` should show expected version","status":"closed","priority":3,"issue_type":"task","owner":"george.kontridze@gmail.com","created_at":"2026-01-15T22:00:33.575601-08:00","created_by":"gkze","updated_at":"2026-01-16T01:21:29.930645-08:00","closed_at":"2026-01-16T01:21:29.930645-08:00","close_reason":"DataGrip 2025.3.3 installed via Nix overlay with auto-updater in update.py"}
